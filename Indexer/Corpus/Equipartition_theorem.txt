equipartition theorem wikipedia equipartition theorem in classical statistical mechanics the equipartition theorem relates the temperature of a system to its average energies the equipartition theorem is also known as the law of equipartition equipartition of energy or simply equipartition the original idea of equipartition was that in thermal equilibrium energy is shared equally among all of its various forms for example the average kinetic energy per degree of freedom in translational motion of a molecule should equal that in rotational motion the equipartition theorem makes quantitative predictions like the virial theorem it gives the total average kinetic and potential energies for a system at a given temperature from which the systems heat capacity can be computed however equipartition also gives the average values of individual components of the energy such as the kinetic energy of a particular particle or the potential energy of a single spring for example it predicts that every atom in a monatomic ideal gas has an average kinetic energy of 32 k b t in thermal equilibrium where k b is the boltzmann constant and t is the thermodynamic temperature more generally equipartition can be applied to any classical system in thermal equilibrium no matter how complicated it can be used to derive the ideal gas law and the dulongpetit law for the specific heat capacities of solids the equipartition theorem can also be used to predict the properties of stars even white dwarfs and neutron stars since it holds even when relativistic effects are considered although the equipartition theorem makes accurate predictions in certain conditions it is inaccurate when quantum effects are significant such as at low temperatures when the thermal energy k b t is smaller than the quantum energy spacing in a particular degree of freedom the average energy and heat capacity of this degree of freedom are less than the values predicted by equipartition such a degree of freedom is said to be frozen out when the thermal energy is much smaller than this spacing for example the heat capacity of a solid decreases at low temperatures as various types of motion become frozen out rather than remaining constant as predicted by equipartition such decreases in heat capacity were among the first signs to physicists of the 19th century that classical physics was incorrect and that a new more subtle scientific model was required along with other evidence equipartitions failure to model black-body radiation also known as the ultraviolet catastrophe led max planck to suggest that energy in the oscillators in an object which emit light were quantized a revolutionary hypothesis that spurred the development of quantum mechanics and quantum field theory basic concept and simple examples edit see also kinetic energy and heat capacity the name equipartition means equal division as derived from the latin equi from the antecedent quus equal or even and partition from the noun partitio division portion 1 2 the original concept of equipartition was that the total kinetic energy of a system is shared equally among all of its independent parts on the average once the system has reached thermal equilibrium equipartition also makes quantitative predictions for these energies for example it predicts that every atom of an inert noble gas in thermal equilibrium at temperature t has an average translational kinetic energy of 32 k b t where k b is the boltzmann constant as a consequence since kinetic energy is equal to 12massvelocity 2 the heavier atoms of xenon have a lower average speed than do the lighter atoms of helium at the same temperature figure2 shows the maxwellboltzmann distribution for the speeds of the atoms in four noble gases in this example the key point is that the kinetic energy is quadratic in the velocity the equipartition theorem shows that in thermal equilibrium any degree of freedom such as a component of the position or velocity of a particle which appears only quadratically in the energy has an average energy of 1 2 k b t and therefore contributes 1 2 k b to the systems heat capacity this has many applications translational energy and ideal gases edit see also ideal gas the newtonian kinetic energy of a particle of mass m velocity v is given by where v x v y and v z are the cartesian components of the velocity v here h is short for hamiltonian and used henceforth as a symbol for energy because the hamiltonian formalism plays a central role in the most general form of the equipartition theorem since the kinetic energy is quadratic in the components of the velocity by equipartition these three components each contribute 1 2 k b t to the average kinetic energy in thermal equilibrium thus the average kinetic energy of the particle is 32 k b t as in the example of noble gases above more generally in an ideal gas the total energy consists purely of translational kinetic energy by assumption the particles have no internal degrees of freedom and move independently of one another equipartition therefore predicts that the average total energy of an ideal gas of n particles is 32 nk b t it follows that the heat capacity of the gas is 32 nk b and hence in particular the heat capacity of a mole of such gas particles is 32 n a k b 32 r where n a is the avogadro constant and r is the gas constant since r 2 cal mol k equipartition predicts that the molar heat capacity of an ideal gas is roughly 3calmolk this prediction is confirmed by experiment 3 the mean kinetic energy also allows the root mean square speed v rms of the gas particles to be calculated where m n a m is the mass of a mole of gas particles this result is useful for many applications such as grahams law of effusion which provides a method for enriching uranium 4 rotational energy and molecular tumbling in solution edit see also angular velocity and rotational diffusion a similar example is provided by a rotating molecule with principal moments of inertia i 1 i 2 and i 3 the rotational energy of such a molecule is given by where 1 2 and 3 are the principal components of the angular velocity by exactly the same reasoning as in the translational case equipartition implies that in thermal equilibrium the average rotational energy of each particle is 32 k b t similarly the equipartition theorem allows the average more precisely the root mean square angular speed of the molecules to be calculated 5 the tumbling of rigid moleculesthat is the random rotations of molecules in solutionplays a key role in the relaxations observed by nuclear magnetic resonance particularly protein nmr and residual dipolar couplings 6 rotational diffusion can also be observed by other biophysical probes such as fluorescence anisotropy flow birefringence and dielectric spectroscopy 7 potential energy and harmonic oscillators edit equipartition applies to potential energies as well as kinetic energies important examples include harmonic oscillators such as a spring which has a quadratic potential energy where the constant a describes the stiffness of the spring and q is the deviation from equilibrium if such a one-dimensional system has mass m then its kinetic energy h kin is where v and p mv denote the velocity and momentum of the oscillator combining these terms yields the total energy 8 equipartition therefore implies that in thermal equilibrium the oscillator has average energy where the angular brackets denote the average of the enclosed quantity 9 this result is valid for any type of harmonic oscillator such as a pendulum a vibrating molecule or a passive electronic oscillator systems of such oscillators arise in many situations by equipartition each such oscillator receives an average total energy k b t and hence contributes k b to the systems heat capacity this can be used to derive the formula for johnsonnyquist noise 10 and the dulongpetit law of solid heat capacities the latter application was particularly significant in the history of equipartition specific heat capacity of solids edit for more details on the molar specific heat capacities of solids see einstein solid and debye model an important application of the equipartition theorem is to the specific heat capacity of a crystalline solid each atom in such a solid can oscillate in three independent directions so the solid can be viewed as a system of 3 n independent simple harmonic oscillators where n denotes the number of atoms in the lattice since each harmonic oscillator has average energy k b t the average total energy of the solid is 3 nk b t and its heat capacity is 3 nk b by taking n to be the avogadro constant n a and using the relation r n a k b between the gas constant r and the boltzmann constant k b this provides an explanation for the dulongpetit law of specific heat capacities of solids which stated that the specific heat capacity per unit mass of a solid element is inversely proportional to its atomic weight a modern version is that the molar heat capacity of a solid is 3r 6calmolk however this law is inaccurate at lower temperatures due to quantum effects it is also inconsistent with the experimentally derived third law of thermodynamics according to which the molar heat capacity of any substance must go to zero as the temperature goes to absolute zero 10 a more accurate theory incorporating quantum effects was developed by albert einstein 1907 and peter debye 1911 11 many other physical systems can be modeled as sets of coupled oscillators the motions of such oscillators can be decomposed into normal modes like the vibrational modes of a piano string or the resonances of an organ pipe on the other hand equipartition often breaks down for such systems because there is no exchange of energy between the normal modes in an extreme situation the modes are independent and so their energies are independently conserved this shows that some sort of mixing of energies formally called ergodicity is important for the law of equipartition to hold sedimentation of particles edit see also sedimentation masonweaver equation and brewing potential energies are not always quadratic in the position however the equipartition theorem also shows that if a degree of freedom x contributes only a multiple of x s for a fixed real number s to the energy then in thermal equilibrium the average energy of that part is k b t s there is a simple application of this extension to the sedimentation of particles under gravity 12 for example the haze sometimes seen in beer can be caused by clumps of proteins that scatter light 13 over time these clumps settle downwards under the influence of gravity causing more haze near the bottom of a bottle than near its top however in a process working in the opposite direction the particles also diffuse back up towards the top of the bottle once equilibrium has been reached the equipartition theorem may be used to determine the average position of a particular clump of buoyant mass m b for an infinitely tall bottle of beer the gravitational potential energy is given by where z is the height of the protein clump in the bottle and g is the acceleration due to gravity since s 1 the average potential energy of a protein clump equals k b t hence a protein clump with a buoyant mass of 10 mda roughly the size of a virus would produce a haze with an average height of about 2cm at equilibrium the process of such sedimentation to equilibrium is described by the masonweaver equation 14 history edit this article uses the non si unit of cal mol k for heat capacity because it offers greater accuracy for single digits for an approximate conversion to the corresponding si unit of jmolk such values should be multiplied by 4.2 j cal the equipartition of kinetic energy was proposed initially in 1843 and more correctly in 1845 by john james waterston 15 in 1859 james clerk maxwell argued that the kinetic heat energy of a gas is equally divided between linear and rotational energy 16 in 1876 ludwig boltzmann expanded on this principle by showing that the average energy was divided equally among all the independent components of motion in a system 17 18 boltzmann applied the equipartition theorem to provide a theoretical explanation of the dulongpetit law for the specific heat capacities of solids the history of the equipartition theorem is intertwined with that of specific heat capacity both of which were studied in the 19th century in 1819 the french physicists pierre louis dulong and alexis thrse petit discovered that the specific heat capacities of solid elements at room temperature were inversely proportional to the atomic weight of the element 20 their law was used for many years as a technique for measuring atomic weights 11 however subsequent studies by james dewar and heinrich friedrich weber showed that this dulongpetit law holds only at high temperatures 21 at lower temperatures or for exceptionally hard solids such as diamond the specific heat capacity was lower 22 experimental observations of the specific heat capacities of gases also raised concerns about the validity of the equipartition theorem the theorem predicts that the molar heat capacity of simple monatomic gases should be roughly 3calmolk whereas that of diatomic gases should be roughly 7calmolk experiments confirmed the former prediction 3 but found that molar heat capacities of diatomic gases were typically about 5calmolk 23 and fell to about 3calmolk at very low temperatures 24 maxwell noted in 1875 that the disagreement between experiment and the equipartition theorem was much worse than even these numbers suggest 25 since atoms have internal parts heat energy should go into the motion of these internal parts making the predicted specific heats of monatomic and diatomic gases much higher than 3calmolk and 7calmolk respectively a third discrepancy concerned the specific heat of metals 26 according to the classical drude model metallic electrons act as a nearly ideal gas and so they should contribute 32 n e k b to the heat capacity by the equipartition theorem where n e is the number of electrons experimentally however electrons contribute little to the heat capacity the molar heat capacities of many conductors and insulators are nearly the same 26 several explanations of equipartitions failure to account for molar heat capacities were proposed boltzmann defended the derivation of his equipartition theorem as correct but suggested that gases might not be in thermal equilibrium because of their interactions with the aether 27 lord kelvin suggested that the derivation of the equipartition theorem must be incorrect since it disagreed with experiment but was unable to show how 28 in 1900 lord rayleigh instead put forward a more radical view that the equipartition theorem and the experimental assumption of thermal equilibrium were both correct to reconcile them he noted the need for a new principle that would provide an escape from the destructive simplicity of the equipartition theorem 29 albert einstein provided that escape by showing in 1906 that these anomalies in the specific heat were due to quantum effects specifically the quantization of energy in the elastic modes of the solid 30 einstein used the failure of equipartition to argue for the need of a new quantum theory of matter 11 nernsts 1910 measurements of specific heats at low temperatures 31 supported einsteins theory and led to the widespread acceptance of quantum theory among physicists 32 general formulation of the equipartition theorem edit see also generalized coordinates hamiltonian mechanics microcanonical ensemble and canonical ensemble the most general form of the equipartition theorem states that under suitable assumptions discussed below for a physical system with hamiltonian energy function h and degrees of freedom x n the following equipartition formula holds in thermal equilibrium for all indices m and n 5 9 12 here mn is the kronecker delta which is equal to one if m n and is zero otherwise the averaging brackets is assumed to be an ensemble average over phase space or under an assumption of ergodicity a time average of a single system the general equipartition theorem holds in both the microcanonical ensemble 9 when the total energy of the system is constant and also in the canonical ensemble 5 33 when the system is coupled to a heat bath with which it can exchange energy derivations of the general formula are given later in the article the general formula is equivalent to the following two if a degree of freedom x n appears only as a quadratic term a n x n 2 in the hamiltonian h then the first of these formulae implies that which is twice the contribution that this degree of freedom makes to the average energy thus the equipartition theorem for systems with quadratic energies follows easily from the general formula a similar argument with 2 replaced by s applies to energies of the form a n x n s the degrees of freedom x n are coordinates on the phase space of the system and are therefore commonly subdivided into generalized position coordinates q k and generalized momentum coordinates p k where p k is the conjugate momentum to q k in this situation formula 1 means that for all k using the equations of hamiltonian mechanics 8 these formulae may also be written similarly one can show using formula 2 that and relation to the virial theorem edit see also virial theorem generalized coordinates and hamiltonian mechanics the general equipartition theorem is an extension of the virial theorem proposed in 1870 34 which states that where t denotes time 8 two key differences are that the virial theorem relates summed rather than individual averages to each other and it does not connect them to the temperature t another difference is that traditional derivations of the virial theorem use averages over time whereas those of the equipartition theorem use averages over phase space applications edit ideal gas law edit see also ideal gas and ideal gas law ideal gases provide an important application of the equipartition theorem as well as providing the formula for the average kinetic energy per particle the equipartition theorem can be used to derive the ideal gas law from classical mechanics 5 if q q x q y q z and p p x p y p z denote the position vector and momentum of a particle in the gas and f is the net force on that particle then where the first equality is newtons second law and the second line uses hamiltons equations and the equipartition formula summing over a system of n particles yields by newtons third law and the ideal gas assumption the net force on the system is the force applied by the walls of their container and this force is given by the pressure p of the gas hence where d s is the infinitesimal area element along the walls of the container since the divergence of the position vector q is the divergence theorem implies that where d v is an infinitesimal volume within the container and v is the total volume of the container putting these equalities together yields which immediately implies the ideal gas law for n particles where n n n a is the number of moles of gas and r n a k b is the gas constant although equipartition provides a simple derivation of the ideal-gas law and the internal energy the same results can be obtained by an alternative method using the partition function 35 diatomic gases edit see also two-body problem rigid rotor and harmonic oscillator a diatomic gas can be modelled as two masses m 1 and m 2 joined by a spring of stiffness a which is called the rigid rotor-harmonic oscillator approximation 19 the classical energy of this system is where p 1 and p 2 are the momenta of the two atoms and q is the deviation of the inter-atomic separation from its equilibrium value every degree of freedom in the energy is quadratic and thus should contribute 1 2 k b t to the total average energy and 1 2 k b to the heat capacity therefore the heat capacity of a gas of n diatomic molecules is predicted to be 7 n 1 2 k b the momenta p 1 and p 2 contribute three degrees of freedom each and the extension q contributes the seventh it follows that the heat capacity of a mole of diatomic molecules with no other degrees of freedom should be 72 n a k b 72 r and thus the predicted molar heat capacity should be roughly 7calmolk however the experimental values for molar heat capacities of diatomic gases are typically about 5calmolk 23 and fall to 3calmolk at very low temperatures 24 this disagreement between the equipartition prediction and the experimental value of the molar heat capacity cannot be explained by using a more complex model of the molecule since adding more degrees of freedom can only increase the predicted specific heat not decrease it 25 this discrepancy was a key piece of evidence showing the need for a quantum theory of matter extreme relativistic ideal gases edit see also special relativity white dwarf and neutron star equipartition was used above to derive the classical ideal gas law from newtonian mechanics however relativistic effects become dominant in some systems such as white dwarfs and neutron stars 9 and the ideal gas equations must be modified the equipartition theorem provides a convenient way to derive the corresponding laws for an extreme relativistic ideal gas 5 in such cases the kinetic energy of a single particle is given by the formula taking the derivative of h with respect to the p x momentum component gives the formula and similarly for the p y and p z components adding the three components together gives where the last equality follows from the equipartition formula thus the average total energy of an extreme relativistic gas is twice that of the non-relativistic case for n particles it is 3 nk b t non-ideal gases edit see also virial expansion and virial coefficient in an ideal gas the particles are assumed to interact only through collisions the equipartition theorem may also be used to derive the energy and pressure of non-ideal gases in which the particles also interact with one another through conservative forces whose potential u r depends only on the distance r between the particles 5 this situation can be described by first restricting attention to a single gas particle and approximating the rest of the gas by a spherically symmetric distribution it is then customary to introduce a radial distribution function g r such that the probability density of finding another particle at a distance r from the given particle is equal to 4 r 2 g r where n v is the mean density of the gas 36 it follows that the mean potential energy associated to the interaction of the given particle with the rest of the gas is the total mean potential energy of the gas is therefore where n is the number of particles in the gas and the factor 1 2 is needed because summation over all the particles counts each interaction twice adding kinetic and potential energies then applying equipartition yields the energy equation a similar argument 5 can be used to derive the pressure equation anharmonic oscillators edit see also anharmonic oscillator an anharmonic oscillator in contrast to a simple harmonic oscillator is one in which the potential energy is not quadratic in the extension q the generalized position which measures the deviation of the system from equilibrium such oscillators provide a complementary point of view on the equipartition theorem 37 38 simple examples are provided by potential energy functions of the form where c and s are arbitrary real constants in these cases the law of equipartition predicts that thus the average potential energy equals k b t s not k b t 2 as for the quadratic harmonic oscillator where s 2 more generally a typical energy function of a one-dimensional system has a taylor expansion in the extension q for non-negative integers n there is no n 1 term because at the equilibrium point there is no net force and so the first derivative of the energy is zero the n 0 term need not be included since the energy at the equilibrium position may be set to zero by convention in this case the law of equipartition predicts that 37 in contrast to the other examples cited here the equipartition formula does not allow the average potential energy to be written in terms of known constants brownian motion edit see also brownian motion the equipartition theorem can be used to derive the brownian motion of a particle from the langevin equation 5 according to that equation the motion of a particle of mass m with velocity v is governed by newtons second law where f rnd is a random force representing the random collisions of the particle and the surrounding molecules and where the time constant reflects the drag force that opposes the particles motion through the solution the drag force is often written f drag v therefore the time constant equals m the dot product of this equation with the position vector r after averaging yields the equation for brownian motion since the random force f rnd is uncorrelated with the position r using the mathematical identities and the basic equation for brownian motion can be transformed into where the last equality follows from the equipartition theorem for translational kinetic energy the above differential equation for with suitable initial conditions may be solved exactly on small time scales with t the particle acts as a freely moving particle by the taylor series of the exponential function the squared distance grows approximately quadratically however on long time scales with t the exponential and constant terms are negligible and the squared distance grows only linearly this describes the diffusion of the particle over time an analogous equation for the rotational diffusion of a rigid molecule can be derived in a similar way stellar physics edit see also astrophysics and stellar structure the equipartition theorem and the related virial theorem have long been used as a tool in astrophysics 39 as examples the virial theorem may be used to estimate stellar temperatures or the chandrasekhar limit on the mass of white dwarf stars 40 41 the average temperature of a star can be estimated from the equipartition theorem 42 since most stars are spherically symmetric the total gravitational potential energy can be estimated by integration where m r is the mass within a radius r and r is the stellar density at radius r g represents the gravitational constant and r the total radius of the star assuming a constant density throughout the star this integration yields the formula where m is the stars total mass hence the average potential energy of a single particle is where n is the number of particles in the star since most stars are composed mainly of ionized hydrogen n equals roughly m m p where m p is the mass of one proton application of the equipartition theorem gives an estimate of the stars temperature substitution of the mass and radius of the sun yields an estimated solar temperature of t 14 million kelvins very close to its core temperature of 15 million kelvins however the sun is much more complex than assumed by this modelboth its temperature and density vary strongly with radiusand such excellent agreement 7 relative error is partly fortuitous 43 star formation edit the same formulae may be applied to determining the conditions for star formation in giant molecular clouds 44 a local fluctuation in the density of such a cloud can lead to a runaway condition in which the cloud collapses inwards under its own gravity such a collapse occurs when the equipartition theoremor equivalently the virial theorem is no longer valid ie when the gravitational potential energy exceeds twice the kinetic energy assuming a constant density for the cloud yields a minimum mass for stellar contraction the jeans mass m j substituting the values typically observed in such clouds t 150k 2 10 16 gcm 3 gives an estimated minimum mass of 17 solar masses which is consistent with observed star formation this effect is also known as the jeans instability after the british physicist james hopwood jeans who published it in 1902 45 derivations edit kinetic energies and the maxwellboltzmann distribution edit the original formulation of the equipartition theorem states that in any physical system in thermal equilibrium every particle has exactly the same average kinetic energy 32 k b t 46 this may be shown using the maxwellboltzmann distribution see figure 2 which is the probability distribution for the speed of a particle of mass m in the system where the speed v is the magnitude of the velocity vector the maxwellboltzmann distribution applies to any system composed of atoms and assumes only a canonical ensemble specifically that the kinetic energies are distributed according to their boltzmann factor at a temperature t 46 the average kinetic energy for a particle of mass m is then given by the integral formula as stated by the equipartition theorem the same result can also be obtained by averaging the particle energy using the probability of finding the particle in certain quantum energy state 35 quadratic energies and the partition function edit more generally the equipartition theorem states that any degree of freedom x which appears in the total energy h only as a simple quadratic term ax 2 where a is a constant has an average energy of k b t in thermal equilibrium in this case the equipartition theorem may be derived from the partition function z where 1 k b t is the canonical inverse temperature 47 integration over the variable x yields a factor in the formula for z the mean energy associated with this factor is given by as stated by the equipartition theorem general proofs edit general derivations of the equipartition theorem can be found in many statistical mechanics textbooks both for the microcanonical ensemble 5 9 and for the canonical ensemble 5 33 they involve taking averages over the phase space of the system which is a symplectic manifold to explain these derivations the following notation is introduced first the phase space is described in terms of generalized position coordinates q j together with their conjugate momenta p j the quantities q j completely describe the configuration of the system while the quantities q j p j together completely describe its state secondly the infinitesimal volume of the phase space is introduced and used to define the volume e e of the portion of phase space where the energy h of the system lies between two limits e and e e in this expression e is assumed to be very small e e similarly e is defined to be the total volume of phase space where the energy is less than e since e is very small the following integrations are equivalent where the ellipses represent the integrand from this it follows that is proportional to e where e is the density of states by the usual definitions of statistical mechanics the entropy s equals k b log e and the temperature t is defined by the canonical ensemble edit in the canonical ensemble the system is in thermal equilibrium with an infinite heat bath at temperature t in kelvins 5 33 the probability of each state in phase space is given by its boltzmann factor times a normalization factor which is chosen so that the probabilities sum to one where 1 k b t integration by parts for a phase-space variable x k which could be either q k or p k between two limits a and b yields the equation where d k d d x k ie the first integration is not carried out over x k the first term is usually zero either because x k is zero at the limits or because the energy goes to infinity at those limits in that case the equipartition theorem for the canonical ensemble follows immediately here the averaging symbolized by is the ensemble average taken over the canonical ensemble the microcanonical ensemble edit in the microcanonical ensemble the system is isolated from the rest of the world or at least very weakly coupled to it 9 hence its total energy is effectively constant to be definite we say that the total energy h is confined between e and e d e for a given energy e and spread d e there is a region of phase space in which the system has that energy and the probability of each state in that region of phase space is equal by the definition of the microcanonical ensemble given these definitions the equipartition average of phase-space variables x m which could be either q k or p k and x n is given by where the last equality follows because e is a constant that does not depend on x n integrating by parts yields the relation since the first term on the right hand side of the first line is zero it can be rewritten as an integral of h e on the hypersurface where h e substitution of this result into the previous equation yields since the equipartition theorem follows thus we have derived the general formulation of the equipartition theorem which was so useful in the applications described above limitations edit requirement of ergodicity edit see also ergodicity chaos theory kolmogorovarnoldmoser theorem and solitons the law of equipartition holds only for ergodic systems in thermal equilibrium which implies that all states with the same energy must be equally likely to be populated 9 consequently it must be possible to exchange energy among all its various forms within the system or with an external heat bath in the canonical ensemble the number of physical systems that have been rigorously proven to be ergodic is small a famous example is the hard-sphere system of yakov sinai 48 the requirements for isolated systems to ensure ergodicity and thus equipartitionhave been studied and provided motivation for the modern chaos theory of dynamical systems a chaotic hamiltonian system need not be ergodic although that is usually a good assumption 49 a commonly cited counter-example where energy is not shared among its various forms and where equipartition does not hold in the microcanonical ensemble is a system of coupled harmonic oscillators 49 if the system is isolated from the rest of the world the energy in each normal mode is constant energy is not transferred from one mode to another hence equipartition does not hold for such a system the amount of energy in each normal mode is fixed at its initial value if sufficiently strong nonlinear terms are present in the energy function energy may be transferred between the normal modes leading to ergodicity and rendering the law of equipartition valid however the kolmogorovarnoldmoser theorem states that energy will not be exchanged unless the nonlinear perturbations are strong enough if they are too small the energy will remain trapped in at least some of the modes another way ergodicity can be broken is by the existence of nonlinear soliton symmetries in 1953 fermi pasta ulam and tsingou conducted computer simulations of a vibrating string that included a non-linear term quadratic in one test cubic in another and a piecewise linear approximation to a cubic in a third they found that the behavior of the system was quite different from what intuition based on equipartition would have led them to expect instead of the energies in the modes becoming equally shared the system exhibited a very complicated quasi-periodic behavior this puzzling result was eventually explained by kruskal and zabusky in 1965 in a paper which by connecting the simulated system to the kortewegde vries equation led to the development of soliton mathematics failure due to quantum effects edit see also ultraviolet catastrophe history of quantum mechanics and identical particles the law of equipartition breaks down when the thermal energy k b t is significantly smaller than the spacing between energy levels equipartition no longer holds because it is a poor approximation to assume that the energy levels form a smooth continuum which is required in the derivations of the equipartition theorem above 5 9 historically the failures of the classical equipartition theorem to explain specific heats and blackbody radiation were critical in showing the need for a new theory of matter and radiation namely quantum mechanics and quantum field theory 11 to illustrate the breakdown of equipartition consider the average energy in a single quantum harmonic oscillator which was discussed above for the classical case neglecting the irrelevant zero-point energy term its quantum energy levels are given by e n nh where h is the planck constant is the fundamental frequency of the oscillator and n is an integer the probability of a given energy level being populated in the canonical ensemble is given by its boltzmann factor where 1 k b t and the denominator z is the partition function here a geometric series its average energy is given by substituting the formula for z gives the final result 9 at high temperatures when the thermal energy k b t is much greater than the spacing h between energy levels the exponential argument h is much less than one and the average energy becomes k b t in agreement with the equipartition theorem figure 10 however at low temperatures when h k b t the average energy goes to zerothe higher-frequency energy levels are frozen out figure 10 as another example the internal excited electronic states of a hydrogen atom do not contribute to its specific heat as a gas at room temperature since the thermal energy k b t roughly 0.025 ev is much smaller than the spacing between the lowest and next higher electronic energy levels roughly 10ev similar considerations apply whenever the energy level spacing is much larger than the thermal energy for example this reasoning was used by max planck and albert einstein to resolve the ultraviolet catastrophe of blackbody radiation 50 the paradox arises because there are an infinite number of independent modes of the electromagnetic field in a closed container each of which may be treated as a harmonic oscillator if each electromagnetic mode were to have an average energy k b t there would be an infinite amount of energy in the container 50 51 however by the reasoning above the average energy in the higher-frequency modes goes to zero as goes to infinity moreover plancks law of black body radiation which describes the experimental distribution of energy in the modes follows from the same reasoning 50 other more subtle quantum effects can lead to corrections to equipartition such as identical particles and continuous symmetries the effects of identical particles can be dominant at very high densities and low temperatures for example the valence electrons in a metal can have a mean kinetic energy of a few electronvolts which would normally correspond to a temperature of tens of thousands of kelvins such a state in which the density is high enough that the pauli exclusion principle invalidates the classical approach is called a degenerate fermion gas such gases are important for the structure of white dwarf and neutron stars at low temperatures a fermionic analogue of the boseeinstein condensate in which a large number of identical particles occupy the lowest-energy state can form such superfluid electrons are responsible for superconductivity